Title: Factorization Machine with Quadratic-Optimization Annealing for RNA Inverse Folding and Evaluation of Binary-Integer Encoding and Nucleotide Assignment

URL Source: https://arxiv.org/pdf/2602.16643v1

Published Time: Thu, 19 Feb 2026 02:01:40 GMT

Number of Pages: 17

Markdown Content:
# Factorization Machine with Quadratic-Optimization Annealing for RNA Inverse Folding and Evaluation of Binary-Integer Encoding and Nucleotide Assignment 

## Shuta Kikuchi 1,2* and Shu Tanaka 1,2,3,4 

> 1

Graduate School of Science and Technology, Keio University, Yokohama, Kanagawa 223-8522, Japan 

> 2

Keio University Sustainable Quantum Artificial Intelligence Center (KSQAIC), Keio University, Minato-ku, Tokyo 108-8345, Japan 

> 3

Department of Applied Physics and Physico-Informatics, Keio University, Yokohama, Kanagawa 223-8522, Japan 

> 4

Human Biology-Microbiome-Quantum Research Center (WPI-Bio2Q), Keio University, Minato-ku, Tokyo 108-8345, Japan 

> *

kikuchi.shuta@keio.jp 

## ABSTRACT 

The RNA inverse folding problem aims to identify nucleotide sequences that preferentially adopt a given target secondary structure. While various heuristic and machine learning-based approaches have been proposed, many require a large number of sequence evaluations, which limits their applicability when experimental validation is costly. We propose a method to solve the problem using a factorization machine with quadratic-optimization annealing (FMQA). FMQA is a discrete black-box optimization method reported to obtain high-quality solutions with a limited number of evaluations. Applying FMQA to the problem requires converting nucleotides into binary variables. However, the influence of integer-to-nucleotide assignments and binary-integer encoding on the performance of FMQA has not been thoroughly investigated, even though such choices determine the structure of the surrogate model and the search landscape, and thus can directly affect solution quality. Therefore, this study aims both to establish a novel FMQA framework for RNA inverse folding and to analyze the effects of these assignments and encoding methods. We evaluated all 24 possible assignments of the four nucleotides to the ordered integers (0-3), in combination with four binary-integer encoding methods. Our results demonstrated that one-hot and domain-wall encodings outperform binary and unary encodings in terms of the normalized ensemble defect value. In domain-wall encoding, nucleotides assigned to the boundary integers (0 and 3) appeared with higher frequency. In the RNA inverse folding problem, assigning guanine and cytosine to these boundary integers promoted their enrichment in stem regions, which led to more thermodynamically stable secondary structures than those obtained with one-hot encoding. 

## Introduction 

Ribonucleic acid (RNA) is an essential molecule that plays an important role in fundamental biological processes, including transcription and translation 1, cellular differentiation and development 2, catalyzing reactions 3, and controlling gene expression 4.In addition, synthetic RNAs are currently utilized in various fields, such as mRNA vaccines 5, RNA aptamers 6, genome editing 7,biosensing 8, ribozymes 9, and riboswitches 10 .RNA function depends on its structure. The primary structure of RNA refers to its linear sequence of four nucleotides linked by phosphodiester bonds. The nucleotides consist of a 5-carbon sugar ribose, a phosphate group, and one of four bases: adenine (A), uracil (U), guanine (G), and cytosine (C). Under physiological conditions, nucleotides in the sequence interact through specific hydrogen bonds to form canonical Watsonâ€“Crick base pairs (A-U, G-C) 11, 12 and, less commonly, wobble base pairs (U-G) 13 . Those base-pairing interactions lead to the creation of the secondary structure. Then, this secondary structure guides the formation of the three-dimensional structure, referred to as the tertiary structure. Although RNA function ultimately depends on its three-dimensional structure, which is determined by the underlying secondary structure arising from base-pairing interactions, synthetic RNAs can be readily constructed with arbitrary nucleotide sequences 14 . Consequently, the task of identifying RNA sequences that fold into a desired secondary structure (target structure) is known as the RNA inverse folding problem 15 (Fig. 1). This problem is typically formulated as the search for an RNA sequence whose minimum free energy (MFE) structure matches the target structure. Theoretical results have shown that the problem is NP-hard, both in its most general formulation and even under simplified energy models 16, 17 .Several approaches have been developed to solve the RNA inverse folding problem. The pioneering tool, RNAinverse 15 , uses an adaptive random walk to minimize the base pair distance between the MFE secondary structure of the current sequence and 1    

> arXiv:2602.16643v1 [cs.LG] 18 Feb 2026 U
> CG
> C
> C
> GG
> UU
> A
> C
> G
> U
> CA
> A
> U
> C
> G
> C
> CGG
> U
> U
> A
> C
> G
> U
> C
> AA
> Folding Comparison
> Target
> secondary structure
> Predicted
> secondary structure
> RNA
> sequence

RNA inverse folding problem Figure 1. Overview of the RNA inverse folding problem. White circles represent arbitrary nucleotides in target secondary structure, and black lines indicate base pairs formed through hydrogen bonding. A, U, G, and C denote adenine, uracil, guanine, and cytosine, respectively. the target structure. Other approaches use stochastic local search 18â€“21 , genetic algorithms 22â€“24 , constraint programming 25 , ant colony optimization 26 , and Monte Carlo methods 27 . In addition, deep learning-based approaches have been proposed, including supervised learning from human solutions 28, 29 , reinforcement learning 30, 31 , and generative models 32 , and transformer-based deep representation learning 33 . These methods have advanced the field of the RNA inverse folding problem by achieving high success rates and producing high-quality sequences on difficult benchmark problems. However, the need for a large number of samples during the search process or for large-scale training data remains a limitation. Although digitally folded RNA sequences are commonly used for evaluation, wet-lab experiments benefit from approaches that limit the number of evaluations, given the considerable time and resource costs associated with experimental validation. Black-box (BB) optimization methods that aim to reduce the number of expensive evaluations by combining surrogate modeling with iterative optimization have been actively studied 34â€“36 . These approaches construct a surrogate model from a limited number of observed samples and exploit it to efficiently search for better candidates, which leads to reduced overall evaluation cost. Recently, factorization machine with quadratic-optimization annealing (FMQA) 37 has been proposed as a discrete black-box optimization method that employs a factorization machine (FM) 38 as a surrogate model and performs optimization using quadratic optimization solvers. Originally, this framework is referred to as factorization machine with quantum annealing (FMQA) 39 . Ising machines are commonly used as quadratic optimization solvers. Ising machines have attracted attention as accurate and efficient solvers for combinatorial optimization problems 40 . Various types of Ising machines have been developed. Quantum annealing machines 41 are implemented using superconducting circuits, and their internal algorithm is quantum annealing 42, 43 . Digital Ising machines 44â€“47 are implemented using digital circuits, such as graphics processing units (GPU), field-programmable gate arrays (FPGA). Their internal algorithms are based on simulated annealing (SA) 48, 49 , simulated quantum annealing 50 , and simulated bifurcations 51 . To tackle a combinatorial optimization problem on an Ising machine, the problem must be formulated as a quadratic unconstrained binary optimization (QUBO) model. The QUBO model is given as 

HQUBO ({xxx}) = âˆ‘ 

> 1â‰¤iâ‰¤jâ‰¤N

Qi, jxix j, (1) where xi âˆˆ { 0, 1} and Qi, j is the ( i, j)-th element of the N-by-N QUBO matrix Q. Thus, a limitation of the Ising machines has been the need to manually construct a suitable QUBO of the target model. However, in FMQA, this issue is handled by the mathematical equivalence between FM and QUBO. The FM is defined by 

HFM ({xxx}) = Ï‰0 +

> N

# âˆ‘

> i=1

Ï‰ixi + âˆ‘ 

> 1â‰¤i<jâ‰¤N

âŸ¨vvvi, vvv jâŸ©xix j, (2) where Ï‰0 âˆˆ R, Ï‰i âˆˆ R, and vvvi âˆˆ RK (i = 1, . . . , N) are the model parameters. The parameter K âˆˆ N is the hyperparameter of the FM. The symbol âŸ¨Â· , Â·âŸ© denotes the inner product. The FM model in Eq. (2) can be converted into a QUBO model. The diagonal elements of the Q correspond to linear coefficients Ï‰i since x2 

> i

= xi for any i, while the off-diagonal elements are given by âŸ¨vvvi, vvv jâŸ©. Therefore, Ising machines can be applied even to problems where explicit QUBO modeling is difficult using FMQA. FMQA has been successfully applied to various domains, including material design 39, 52â€“54 , polymer design 55, 56 ,engineering design 57, 58 , feature selection 59, 60 . Previous studies have reported that it can obtain high-quality solutions with fewer evaluations compared to random search, genetic algorithms, particle swarm optimization, and Bayesian optimization, which is a representative BB optimization method 39, 52, 56, 58 .In this study, we proposed a novel approach for applying FMQA to the RNA inverse folding problem. To tackle the problem using FMQA, it is necessary to convert nucleotides, which are categorical variables, into binary variables. Variables with more 

> 2/17

than two discrete states are commonly encoded as binary variables using binary-integer encoding. In contrast, a previous study employed a binary variational autoencoder (bVAE) to learn binary latent representations of amino acids 55 . The advantage of bVAE is its ability to efficiently convert a vast variety of variables, such as amino acids, while reducing the total number of required binary variables. However, since our study focuses on only four types of nucleotides, conventional binary-integer encoding is sufficient. Several types of binary-integer encoding exist, and a previous study has reported that the choice of encoding can significantly influence the performance of FMQA 61 . A previous study has demonstrated that an appropriate mapping to binary variables can reshape the energy landscape, reduce the probability of being trapped in local minima, and thereby improve the solution quality of FMQA 62 . It is also known that the specific encoding method affects the solution accuracy when solving problems with Ising machines 63â€“66 . While a previous report has analyzed the effects of converting ordered integers into binary variables 61 , there are no studies that analyze the role of binary-integer encoding when handling categorical variables within FMQA. Because nucleotides are categorical variables, their assignment to an integer is inherently arbitrary, and different binary-integer encoding methods may introduce distinct search biases. Therefore, this study investigates how binary-integer encodings and integer-to-nucleotide assignments influence solution quality in FMQA. Furthermore, we aim to evaluate the applicability of FMQA to the RNA inverse folding problem. The insights obtained here provide practical guidelines for applying FMQA to categorical optimization problems and lay the methodological foundation for its use in realistic RNA inverse folding scenarios. 

## Results 

Objective function of RNA inverse folding problem 

The RNA inverse folding problem aims to identify an RNA sequence that preferentially adopts a target structure. In practical applications, the quality of an RNA sequence designed for a target secondary structure is evaluated by experimental validation. However, to evaluate the proposed method, we use the ensemble defect as a computationally evaluable objective function in this study. The ensemble defect quantifies the expected number of nucleotides whose pairing status differs from that of the target secondary structure over the Boltzmann ensemble of RNA secondary structures. This metric evaluates not only the agreement between the MFE structure and the target structure, but also the thermodynamic stability of the target structure within the ensemble. Since its introduction by Dirks et al. 67 , ensemble defect has been adopted in several subsequent studies 20, 21, 25 .Dirks et al. demonstrated that ensemble defect outperforms structure distance based on MFE, achieving higher success rates in obtaining sequences that uniquely fold into the target structure 67 . More recently, Ward et al. confirmed that ensemble defect consistently performs better than structure distance between the MFE structure and target structure across diverse benchmarks 68 .Therefore, we used the ensemble defect. An RNA sequence nnn of length L is represented by a string of nucleotides ni âˆˆ { A, U, G, C }. The secondary structure s of 

nnn is defined as a set of paired positions (i, j) ( i < j) such that (ni, n j) forms an allowed base-pair type (A-U, G-C, or U-G). Although natural RNAs may contain pseudoknots or higher-order interactions, these structural features are not supported by the folding model used here. Therefore, we consider only pseudoknot-free secondary structures. Under the nearest-neighbor thermodynamic model 69 , each structure s of nnn is assigned a Gibbs free energy âˆ†G(nnn, s).Assuming thermodynamic equilibrium at temperature T , the probability of observing s follows the Boltzmann distribution 

p(s | nnn) = exp (âˆ’âˆ†G(nnn, s)/(RT )) 

Z(nnn) , (3) where R is the molar gas constant and 

Z(nnn) = âˆ‘

> sâˆˆS(nnn)

exp (âˆ’âˆ†G(nnn, s)/(RT )) (4) is the partition function, with S(nnn) denoting the ensemble of all secondary structures that nnn can possibly fold into. The ensemble defect is defined as the Boltzmann-weighted average structural distance 

Ï† (nnn,t) = âˆ‘

> sâˆˆS(nnn)

p(s | nnn) d(s,t), (5) where d(s,t) denotes the number of nucleotides whose pairing status differs between structure s and the target structure t. The normalized ensemble defect (NED), which ranges between 0 and 1, is given by NED (nnn,t) = Ï† (nnn,t)

L . (6) The evaluation of ensemble defect was performed using the ViennaRNA package 70 .                                 

> 3/17 Construct initial
> training data
> ð· =ð’™ !,NED ð’ ,ð‘¡ !
> Train FM using ð‘«
> â„‹"#
> Obtain new solutions
> using the Ising machine
> ð’™ $%&
> Map binary variables to
> nucleotides
> ð’™ $%& âˆˆ0,1
> ð’› $%& âˆˆ0,1,2,3
> ð’ $%& âˆˆA,U,G,C
> Evaluate the
> BB function
> NED ð’ $%& ,ð‘¡
> Add the new pair
> to the ð‘«
> {(ð’™ $%& ,NED ð’ $%& ,ð‘¡ )}
> RNA
> sequence
> Secondary
> Structure U
> A
> C
> G
> C
> G
> CU
> UUC
> C
> A
> A
> G
> GUUCA
> C
> UCC
> CU

Figure 2. Schematic illustration of the proposed FMQA for the RNA inverse folding problem. As an example, the BB function is defined as the NED. Integer Binary variable sequence One-hot encoding Domain-wall encoding Binary encoding Unary encoding 0 1000 000 00 000 1 0100 100 10 100, 010, 001 2 0010 110 01 110, 101, 011 3 0001 111 11 111 

Table 1. Binary variable sequence representing integers I âˆˆ { 0, 1, 2, 3} under different binary-integer encoding methods. 

Proposed method 

We proposed a novel approach to solve the RNA inverse folding problem based on FMQA. Figure 2 shows the procedure of the proposed method. In practical applications, the BB function is typically assumed to correspond to experimentally measured properties, which may require substantial time and resources. However, to evaluate the applicability of FMQA in a controlled setting, we employed the computationally evaluable NED as the BB function in this study. First, an initial training dataset {(xxxm, NED (nnn,t)m)} (m = 1, . . . , M) is constructed by randomly generating solutions of binary variables xxxm and their corresponding NED (nnn,t)m. We note that M is the number of initial data points. Here, the binary variables xxx are mapped integer variables zzz using binary-integer encoding, and then the integer variables are mapped to nucleotides nnn. Let D denote the dataset constructed from these data points. Next, an FM is trained using the dataset D. The FM model is defined in Eq. (2) . After training, new candidate solutions 

xxxnew are generated by optimizing an acquisition function using an Ising machine. In this study, the predicted cost output by the trained FM is directly employed as the acquisition function. The candidate solutions xxxnew are mapped to strings that represent the corresponding nucleotides nnnnew . Then, the NED (nnnnew ,t) are evaluated using the candidate solutions. The new pairs of solutions and their corresponding NEDs are appended to the dataset D.This procedure, consisting of FM training, optimization using the Ising machine, and BB function evaluation, is repeated for a predefined number of iterations. Finally, the solution with the lowest ensemble defect observed in the dataset D is selected as the best solution obtained by FMQA. 

Binary-integer encoding method 

In this study, we use four types of binary-integer encoding methods: one-hot, domain-wall, binary, and unary encoding. Since RNA consists of four types of nucleotides, each nucleotide can be represented as a discrete integer variable with four possible states. Table 1 presents the binary variable sequences corresponding to each integer I âˆˆ { 0, 1, 2, 3 } for the different binary-integer encoding methods. This subsection explains the binary representations of integers for each encoding method and their integration into FMQA. One-hot encoding is a traditional method. An integer is represented by the position of a single binary variable that takes the 

4/17 value 1 . An integer I is given by I = âˆ‘3 

> i=0

ix i. To handle the one-hot encoding into FMQA, a penalty term is added to the FM model in Eq. (2). The model is given as 

H oh FM = HFM + Î¼

> L

# âˆ‘

> l=1
> 3

# âˆ‘

> i=0

x(l) 

> i

âˆ’ 1

!2

, (7) where Î¼ > 0 is a penalty coefficient that controls the strength of the penalty term, and x(l) 

> i

represents binary variables for an l-th integer variable. Domain-wall encoding was originally proposed by Chancellor 63 . An integer is represented by the number of leading binary variables that take the value 1 , followed by 0 s. An integer is given by I = âˆ‘2 

> i=0

xi. The boundary position between the binary variables set to 1 and those set to 0 is referred to as a domain wall. To enforce the constraint that exactly one domain wall exists, a penalty term is added to the FM model. The extended FM model is given as 

H dw FM = HFM + Î¼

> L

# âˆ‘

> l=11

# âˆ‘

> i=0

x(l)

> i+1

(1 âˆ’ x(l) 

> i

). (8) Binary encoding uses the binary representation for encoding integers. An integer I is given by I = âˆ‘1 

> i=0

2ixi. In the RNA inverse folding problem, binary encoding does not require an additional penalty term, as each binary configuration uniquely corresponds to an integer value. Unary encoding represents an integer by the number of binary variables set to value 1, similar to domain-wall encoding. Since this representation does not impose an explicit structural constraint, no penalty term is required. Unary encoding admits multiple binary representations for a single integer value. When applying FMQA, the total number of binary variables depends on the chosen encoding method. One-hot encoding requires N = 4L, domain-wall and unary encodings require N = 3L, and binary encoding requires N = 2L.A previous study investigated the effect of binary-integer encoding methods on FMQA. One-hot, domain-wall, and binary encoding, were evaluated using the ground-state energy calculation of a hydrogen molecule 61 . The problem was originally formulated with real-valued variables, and these variables were discretized using binary-integer encoding. While all encoding methods achieved high accuracy, one-hot and domain-wall encodings outperformed binary encoding in terms of energy error distribution and stability. In particular, one-hot encoding consistently yielded low energy errors even with small K.

Evaluation of effect of binary-integer encoding method and integer-to-nucleotide assignment 

To investigate the conditions under which FMQA can effectively solve the RNA inverse folding problem, we investigated the effects of binary-integer encoding and integer-to-nucleotide assignment. For binary-integer encoding, we considered one-hot, domain-wall, binary, and unary encodings. For integer-to-nucleotide assignment, we evaluated all possible 4! = 24 assignments of the four nucleotides to the integers (0, 1, 2, 3). For each condition, the optimization was performed independently 10 times. The objective function was the NED. Since the NED represents the structural error with respect to the target structure, the problem is formulated as a minimization task. The number of FMQA iterations was set to 1000 , and the number of initial training data points was set to 10 . We used an SA-based Ising machine 47 , which runs on a GPU. Other parameters are described in the Methods section. As the target structure, we used stickshift from the well-known benchmark Eterna100 71 . This structure consists of 26 nucleotides (nt) and has a relatively simple secondary structure. Thus, it provides an appropriate test case for evaluating the effects of encoding and assignment. Figure 3 shows the solutions obtained by FMQA under different combinations of binary-integer encoding methods and integerâ€“to-nucleotide assignments. The ensemble defect corresponds to the expected number of nucleotides whose pairing status differs from that of the target secondary structure under the Boltzmann ensemble of possible structures. Therefore, a lower NED indicates that the sequence more reliably adopts the target structure. Focusing on the binary-integer encoding methods, one-hot and domain-wall encodings achieved lower NED values compared with binary and unary encodings. Binary encoding yielded lower NED values than unary encoding. With respect to integerâ€“to-nucleotide assignment, the ensemble defect values of domain-wall encoding were relatively high for the assignments (A, G, C, U), (A, C, G, U), (U, G, C, A), and (U, C, G, A). In contrast, one-hot encoding consistently achieved low NED values regardless of the assignment. The objective of the RNA inverse folding problem is to identify RNA sequences whose MFE secondary structure coincides with the target structure. Therefore, we computed the MFE structure for each RNA sequence obtained by FMQA and examined whether it matched the target structure. Solutions whose MFE structures were identical to the target structure were defined as success solutions, and the proportion of success solutions among the 10 runs was defined as the success rate. The success rates under each condition are shown in Fig. 4. Binary and unary encodings exhibited relatively high NED values, and consequently, their success rates were low, with some conditions yielding a success rate of 0.0 . In contrast, one-hot and domain-wall encodings generally achieved high success rates. However, for the assignments in which domain-wall encoding showed high NED values, the success rate was correspondingly low. 

> 5/17

Figure 3. Normalized ensemble defect values obtained by FMQA under different combinations of binary-integer encoding methods and integer-to-nucleotide assignments. Crosses indicate the average NED over 10 runs. The upper and lower whiskers denote the maximum and minimum NED values, respectively. Black circle, red triangle, blue square, and green diamond represent outliers. Panels in the top row correspond to assignments in which A or U was assigned to integer 0, whereas panels in the bottom row correspond to assignments in which G or C was assigned to integer 0. Finally, we analyzed the MFE values of the success solutions. The MFE values of the success solutions are presented in Fig. 5. One-hot encoding yielded solutions with comparable MFE values (approximately âˆ’10 kcal/mol) across all assignments. In contrast, domain-wall encoding exhibited assignment-dependent behavior. For the assignments (A, G, C, U), (A, C, G, U), (U, G, C, A), and (U, C, G, A), where the NED values were high, the corresponding MFE values were also relatively high. Conversely, for the assignments (G, A, U, C), (G, U, A, C), (C, A, U, G), and (C, U, A, G), the MFE values were lower compared to those obtained with other assignments. 

Comparison of the number of BB function evaluations 

In the previous subsection, we analyzed the effects of binary-integer encoding and nucleotides assignments from the viewpoint of final solutions obtained by FMQA. In this subsection, we compare FMQA with other black-box optimization methods in terms of the number of objective function evaluations. In practical applications, each BB function evaluation may correspond to a wet-lab experiment, which typically requires a substantial amount of time. In such settings, the computational time of surrogate training and optimization is negligible compared to the time required for wet-lab experimentation. Therefore, the number of BB function evaluations is the primary performance metric. Although several methods have been proposed for the RNA inverse folding problem 15, 18â€“27 , their objective functions often differ from that used in our study, and in many cases the number of objective function evaluations cannot be directly measured 

> 6/17

Figure 4. Success rate obtained by FMQA under different combinations of binary-integer encoding methods and integer-to-nucleotide assignments. Panels in the top row correspond to assignments in which A or U was assigned to integer 0,whereas panels in the bottom row correspond to assignments in which G or C was assigned to integer 0. or fairly compared. Therefore, in this study, we compared the number of evaluations using Bayesian optimization and a genetic algorithm (GA), both using NED as the objective function. For Bayesian optimization, we employed the tree-structured Parzen estimator (TPE), which can directly handle categorical variables. For FMQA, we used the integer-to-nucleotide assignment (G, A, U, C), which achieved a success rate of 1.0 , low MFE values, and the lowest NED among the domain-wall encoding results in the previous subsection. The results obtained with one-hot and domain-wall encodings under this assignment were used for comparison. In addition, random search (RS) was adopted as a baseline method. All methods were initialized with the same initial dataset as FMQA to ensure a fair comparison. Figure 6 shows the relationship between the number of NED evaluations and the best NED value obtained up to each evaluation for each method. Each method was independently performed 10 times, and the mean and standard deviation across runs are presented. As shown in Fig. 6, FMQA achieved lower NED values with fewer evaluations compared to the other methods. The result demonstrates its efficiency in reducing the number of expensive objective function evaluations in the RNA inverse folding problem. 

Performance on multiple target secondary structures 

In this subsection, we evaluated the performance of FMQA on target secondary structures other than stickshift .From the Eterna100 benchmark, we selected eight structures with relatively small nucleotide lengths (12â€“36 nt). The selected target structures are shown in Fig. 7. FMQA was performed using the integer-to-nucleotide assignment (G, A, U, C), which demonstrated better performance in the previous subsection. We compared one-hot and domain-wall encoding under the same experimental conditions. For each target structure, the optimization was independently executed 10 times. Figure 8(a) presents the NED obtained for each structure. Overall, domain-wall encoding achieved lower NED values than one-hot encoding for most target structures. In particular, for G-C Placement , Simple Hairpin , stickshift , and Corner bulge training , both encoding methods consistently yielded low NED values across runs. In contrast, Shortie 4 and Small and Easy 6 

showed relatively higher NED values. The corresponding success rates are shown in Fig. 8(b). Except for Shortie 4 and Small and Easy 6 , at least two success solutions were obtained for each structure using both encoding methods. Notably, for G-C Placement, Simple Hairpin, stickshift , and Corner bulge training , the success rate was high for both encodings. In contrast, 

Prion Pseudoknot â€“ Difficulty Level 0 and infoRNA test 16 exhibited lower success rates compared with their target structures. 

> 7/17

Figure 5. Minimum free energy values obtained by FMQA under different combinations of binary-integer encoding methods and integer-to-nucleotide assignments. Only success solutions are plotted. When two or more success solutions were obtained, their average MFE value is indicated by a cross marker. When three or more success solutions were obtained, the standard deviation is shown as error bars. Panels in the top row correspond to assignments in which A or U was assigned to integer 0, whereas panels in the bottom row correspond to assignments in which G or C was assigned to integer 0. Figure 8(c) shows the MFE values of the success solutions. Consistent with the NED, domain-wall encoding achieved lower MFE values than one-hot encoding for most target structures. 

## Discussion 

In this study, we demonstrated that, in the RNA inverse folding problem solved by FMQA, one-hot and domain-wall encodings achieved better solutions than binary and unary encodings. This is consistent with a previous study that investigated the effect of binary-integer encoding methods on FMQA when continuous variables were discretized into binary variables 61 . In that study, the energy error, defined as the difference between the optimal objective value and the value obtained by FMQA, was smaller for one-hot and domain-wall encodings than for binary encoding. In contrast, a previous study on the relationship between Ising machines and binary-integer encodings reported that binary and unary encodings sometimes outperformed one-hot encoding in terms of feasibility rate and objective value quality 64 . These findings suggest that, in FMQA, the choice of binary-integer encoding primarily influences solution quality through the construction and expressivity of the FM, rather than through the optimization performance of the Ising machine. Binary encoding represents four nucleotides using only two binary variables. Although this representation is compact, it may limit the expressive capacity of the FM to model complex nonlinear interactions among categorical states. For unary encoding, multiple binary configurations correspond to the same integer value. This redundancy increases representational degeneracy. The FM must implicitly learn that these distinct binary configurations correspond to the same nucleotide, which may complicate surrogate modeling and reduce optimization efficiency. Therefore, the observed degradation in solution quality for unary encoding may be attributed to the inability of the FM to properly capture this many-to-one mapping structure. We next discuss the effect of integerâ€“to-nucleotide assignment. In domain-wall encoding, certain assignments resulted in different NED and MFE values. To analyze these results, we investigated nucleotide frequency in the solutions obtained under all assignments. Based on the secondary structure, nucleotides were categorized into stem regions (base-paired positions) and non-stem regions (unpaired positions). Nucleotide frequencies were calculated by pooling all nucleotides from the successful solutions obtained in 10 independent runs and normalizing by the total number of nucleotides. The results are shown in Fig. 9.      

> 8/17 0200 400 600 800 1000
> The number of BB function evaluations
> 0.0
> 0.1
> 0.2
> 0.3
> 0.4
> 0.5
> 0.6
> Normalized ensemble defect  FMQA (One-hot)
> FMQA (Domain-wall)
> TPE
> GA
> RS

Figure 6. Relationship between the number of BB function evaluations and the best normalized ensemble defect value up to each evaluation. Figure 9(a) shows nucleotide frequency in stem regions, Fig. 9(b) in non-stem regions, and Fig. 9(c) across the entire sequence. The baseline value of 0.25 corresponds to uniform nucleotide frequency. The heatmap shows the deviation of nucleotide frequency from this uniform expectation. In stem regions(Fig. 9(a)), one-hot encoding consistently exhibited high G and C frequency across all assignments. This observation agrees with previous reports on RNA inverse folding 18, 19, 24, 67 . G-C base pairs form three hydrogen bonds and are typically more stable than A-U or U-G pairs. The stability of the structure is determined by nearest-neighbor stacking interactions between adjacent base pairs. In the Turner thermodynamic model implemented in the ViennaRNA package, G-C stacks exhibit the most favorable free energies, explaining why enrichment of G-C pairs in stem regions lowers MFE and reduces ensemble defect 69, 72 . In contrast, domain-wall encoding exhibited assignment-dependent results. In assignments where A-U and U-G pairs were more prevalent in stems, NED and MFE values were higher: (A, G, C, U), (A, C, G, U), (U, G, C, A), and (U, C, G, A). These assignments correspond to those that showed inferior optimization performance. Since A-U and U-G pairs are thermodynamically less stable than G-C pairs, enrichment of these pairs in stems increases free energy and reduces structural stability. Meanwhile, assignments in which G-C frequency in stems exceeded that of one-hot encoding corresponded to lower MFE values, (G, A, U, C), (G, U, A, C), (C, A, U, G), and (C, U, A, G). This further supports the interpretation that stem thermodynamic stability directly influences FMQA performance in RNA inverse folding. In non-stem regions(Fig. 9(b)), one-hot encoding showed a high frequency of adenine, consistent with the results of previous methods 24 . Adenine forms canonical base pairs only with uracil. Compared with guanine, which can pair with both cytosine and uracil, adenine reduces the likelihood of unintended base pairing. Although cytosine also pairs with only guanine, erroneous C-G pairing is energetically more stabilizing than A-U pairing. Therefore, placing adenine in loop regions reduces the risk of forming undesired stable alternative structures, thereby lowering the ensemble defect. In domain-wall encoding, adenine frequency remained relatively high in non-stem regions. However, the frequency of other nucleotides varied substantially depending on assignment. Notably, nucleotides assigned to integer 0 tended to exhibit higher frequency. When examining overall nucleotide frequency (Fig. 9(c)), domain-wall encoding showed increased frequency for nucleotides assigned to integers 0 and 3. This phenomenon can be interpreted from the viewpoint of Hamming distance between binary representations. In one-hot encoding, the Hamming distance between any pair of integers is uniformly two. In contrast, domain-wall encoding exhibits asymmetric distances. Adjacent integers differ by Hamming distance one, whereas non-adjacent integers differ by two or three binary variables. Adjacent integers are directly connected within the feasible subspace, while non-adjacent integers are separated by larger Hamming distances 66 . In domain-wall encoding, integers 0 and 3 each have only one neighboring integer, whereas middle integers ( 1 and 2) have two such neighbors. This asymmetry may bias the search dynamics, making transitions away from 0 and 3 less frequent. As a result, nucleotides assigned to boundary integers 0 and 3 may appear more frequently in the optimized sequences. In the present study, we did not explicitly constrain GC content or impose thermodynamic priors beyond ensemble defect minimization. Therefore, achieving low free energy is central to success in the RNA inverse folding problem considered here. The results suggest that, when using domain-wall encoding, careful design of integerâ€“to-nucleotide assignment can exploit encoding-specific search biases. For example, assigning G and C to integers whose binary representations are less prone to       

> 9/17 (a) (b) (c) (d)
> (e) (f) (g) (h)

Figure 7. Target secondary structures selected from the Eterna100 benchmark and evaluated in this study. White circles represent nucleotides, and black lines indicate base pairs formed by hydrogen bonding. The target structures are: (a) G-C Placement (12 nt), (b) Simple Hairpin (16 nt), (c) Shortie 4 (17 nt), (d) stickshift (26 nt), (e) Small and Easy 6 (30 nt), (f) 

Corner bulge training (31 nt), (g) Prion Pseudoknot â€“ Difficulty Level 0 (36 nt), and (h) infoRNA test 16 (36 nt). transition may enhance stem stability and reduce free energy. Thus, domain-wall encoding provides not only a representation method but also an opportunity for encoding-aware problem design. Finally, we discuss the influence of target secondary structure on FMQA performance. In the RNA inverse folding problem, it has been reported that structures containing very short stems (e.g., two base pairs) flanked by unpaired nucleotides are particularly difficult to design 71 . Such short stems are thermodynamically unstable and can be easily disrupted by alternative competing structures, making it difficult to identify sequences that uniquely fold into the target structure. Among the target structures evaluated in this study, Shortie 4 and Small and Easy 6 , for which almost no success solutions were obtained, exhibit this characteristic feature. Our results indicate that FMQA also struggles with these inherently unstable structural motifs. In contrast, bulge-loop structures, where one strand of a continuous helix contains unpaired nucleotides, are also known to increase design difficulty because they introduce asymmetry and local flexibility. Nevertheless, FMQA successfully obtained solutions for Corner bulge training , which contains such bulge motifs. This result suggests that FMQA can effectively handle certain classes of structural irregularities, provided that the overall stem length remains sufficiently long to ensure thermodynamic stability. Furthermore, even when a structure contains multiple stable stems, increasing the total nucleotide length expands the combinatorial search space exponentially. As sequence length increases, the number of possible nucleotide combinations grows as 4L, thereby increasing the complexity of the optimization landscape. Consequently, the 36 -nt structures (Prion Pseudoknot â€“ Difficulty Level 0 and infoRNA test 16 ) exhibited lower success rates compared with shorter targets. This reduction in performance can be attributed not only to structural complexity but also to the enlarged search space associated with longer sequences. These observations indicate that FMQA performance is influenced by both the thermodynamic stability of local motifs and global combinatorial complexity. Addressing these difficulties may require the introduction of explicit base-pairing constraints or the adoption of motif-level decomposition strategies explored in previous RNA inverse folding studies 18, 67 . Future research will focus on extending the applicability of FMQA to a broader class of RNA inverse folding problems and systematically comparing its performance with established approaches 15, 18â€“33 .

## Methods 

RNA secondary structure analysis 

RNA secondary structure prediction and ensemble evaluation were performed using the ViennaRNA package (v2.7.2) 70 . All calculations were conducted at a constant temperature of 37 â—¦C to reflect physiological conditions. This temperature corresponds to the default setting of the package and has been widely adopted in previous RNA folding studies 15, 21, 24, 68 . For the energy model, the dangle treatment was set to 2 ( -dangles=2 ). This setting accounts for the energetic contributions of dangling ends and terminal mismatches, approximating coaxial stacking effects and providing a thermodynamically consistent estimation of structural stability. 

> 10/17

FMQA settings 

The FM was trained using the AdamW optimizer with a learning rate of 0.01 . The number of training epochs was set to 1000 ,and the mean squared error (MSE) was used as the loss function. The hyperparameter K was determined based on a comparative performance analysis. We evaluated K = 4, 8, 12 , and 16 for each binary-integer encoding method. The integer-to-nucleotide assignment was fixed to (G, A, U, C). For each condition, the optimization was independently performed 10 times. The results are shown in Fig. 10. Figure 10(a) presents the NED values. One-hot and domain-wall encodings exhibited low NED values for all K except K = 4 . Binary encoding showed slight performance degradation at K = 12 , and unary encoding at K = 8 . Across all K, the order of performance was consistent: one-hot and domain-wall encodings achieved the lowest NED values, followed by binary encoding, and finally unary encoding. The success rates are shown in Fig. 10(b). One-hot encoding exhibited a lower success rate at K = 4, whereas domain-wall encoding maintained a high success rate across all K. Figure 10(c) shows the MFE values of the obtained success solutions. For one-hot encoding, the MFE values at K = 8 were slightly higher than those at other K values. In domain-wall encoding, the lowest MFE values were observed at K = 12 . Based on these results, and considering the performance of one-hot and domain-wall encodings, we selected K = 12 for the FMQA experiments reported in the Results section. The trained FM model was solved using an SA-based Ising machine 47 implemented on a GPU. The limit of computation time per optimization run was set to 2000 ms. Before solving the FM model on the Ising machine, all coefficients were normalized by dividing them by the maximum absolute coefficient value. For one-hot and domain-wall encodings, a penalty coefficient was set to Î¼ = 2. During the FMQA iterations with this penalty coefficient, no infeasible solutions were observed. At each FMQA iteration, the Ising machine generated one new candidate solution xxxnew , which was evaluated to evaluate the NED and appended to the dataset. The initial dataset consisted of 10 randomly generated sequences. Each sequence was constructed by randomly selecting nucleotides from the set {A,U, G,C}, with the sequence length equal to that of the target secondary structure. FMQA was performed for 1000 iterations. The best solution observed during the optimization process was selected as the final output of FMQA. The above settings were kept identical across all target secondary structures. 

Baseline optimization methods 

Random search (RS) and tree-structured Parzen estimator (TPE) were implemented using the Optuna package. For TPE, the multivariate parameter was set to True to enable multivariate sampling of categorical variables. The genetic algorithm (GA) was implemented using the pymoo package 73 , which has been used in previous comparative studies with FMQA 56 . The GA was formulated as a single-objective optimization problem. Integer variables representing nucleotides were optimized directly in the range {0, 1, 2, 3}. The population size was set to 10 , identical to the initial dataset size used in FMQA to ensure fair comparison. Uniform crossover was employed with crossover probability 0.9 . Mutation was implemented as a random-reset mutation operator, where each gene was mutated with probability p = 5.0/L, with L denoting the sequence length (for stickshift, L = 26 ). When mutation occurred, the nucleotide value was randomly reassigned to a different integer. The termination criterion was based on the total number of objective function evaluations. The evaluation budget was set to 1000 objective function evaluations, excluding the evaluations of the initial dataset, to match the number of additional NED evaluations performed in FMQA. All methods were initialized with the same initial dataset as FMQA. 

## References 

1. Crick, F. Central dogma of molecular biology. Nature 227 , 561â€“563 (1970). 

2. Morris, K. V. & Mattick, J. S. The rise of regulatory RNA. Nat. Rev. Genet. 15 , 423â€“437 (2014). 

3. Doudna, J. A. & Cech, T. R. The chemical repertoire of natural ribozymes. Nature 418 , 222â€“228 (2002). 

4. Serganov, A. & Patel, D. J. Ribozymes, riboswitches and beyond: regulation of gene expression without proteins. Nat. Rev, Genet. 8, 776â€“790 (2007). 

5. Pardi, N., Hogan, M. J., Porter, F. W. & Weissman, D. mRNA vaccinesâ€”a new era in vaccinology. Nat. Rev. Drug Discov. 

17 , 261â€“279 (2018). 

6. Hamada, M. In silico approaches to RNA aptamer design. Biochimie 145 , 8â€“14 (2018). 

7. Singh, V., Braddick, D. & Dhar, P. K. Exploring the potential of genome editing CRISPR-Cas9 technology. Gene 599 ,1â€“18 (2017). 

8. Jaffrey, S. R. RNA-based fluorescent biosensors for detecting metabolites in vitro and in living cells. Adv. Pharmacol. 82 ,187â€“203 (2018). 

> 11/17

9. Bauer, G. & Suess, B. Engineered riboswitches as novel tools in molecular biology. J. Biotechnol. 124 , 4â€“11 (2006). 

10. Dixon, N. et al. Reengineering orthogonally selective riboswitches. Proc. Natl. Acad. Sci. 107 , 2830â€“2835 (2010). 

11. Seeman, N. C., Rosenberg, J. M., Suddath, F., Kim, J. J. P. & Rich, A. RNA double-helical fragments at atomic resolution: I. The crystal and molecular structure of sodium adenylyl-3â€™, 5â€™-uridine hexahydrate. J. Mol. Biol. 104 , 109â€“144 (1976). 

12. Rosenberg, J. M., Seeman, N. C., Day, R. O. & Rich, A. RNA double-helical fragments at atomic resolution: II. the crystal structure of sodium guanylyl-3â€™, 5â€™-cytidine nonahydrate. J. Mol. Biol. 104 , 145â€“167 (1976). 

13. Varani, G. & McClain, W. H. The GÂ· U wobble base pair. EMBO Rep. 1, 18â€“23 (2000). 

14. Reese, C. B. Oligo-and poly-nucleotides: 50 years of chemical synthesis. Org. Biom. Chem. 3, 3851â€“3868 (2005). 

15. Hofacker, I. L. et al. Fast folding and comparison of RNA secondary structures. Monats. Chem. 125 , 167â€“188 (1994). 

16. Schnall-Levin, M., Chindelevitch, L. & Berger, B. Inverting the Viterbi algorithm: an abstract framework for structure design. In Proceedings of the 25th international conference on machine learning , 904â€“911 (2008). 

17. Bonnet, Ã‰., Rz Ë› aË™ zewski, P. & Sikora, F. Designing RNA secondary structures is hard. J. Comput. Biol. 27 , 302â€“316 (2020). 

18. Andronescu, M., Fejes, A. P., Hutter, F., Hoos, H. H. & Condon, A. A new algorithm for RNA secondary structure design. 

J. Mol. Biol. 336 , 607â€“624 (2004). 

19. Busch, A. & Backofen, R. INFO-RNAâ€”a fast approach to inverse RNA folding. Bioinformatics 22 , 1823â€“1831 (2006). 

20. Zadeh, J. N., Wolfe, B. R. & Pierce, N. A. Nucleic acid sequence design via efficient ensemble defect optimization. J. Comput. Chem. 32 , 439â€“452 (2011). 

21. Zadeh, J. N. et al. NUPACK: Analysis and design of nucleic acid systems. J. Comput. Chem. 32 , 170â€“173 (2011). 

22. Taneda, A. MODENA: a multi-objective RNA inverse folding. Adv. Appl. Bioinform. Chem. 1â€“12 (2010). 

23. LyngsÃ¸, R. B. et al. Frnakenstein: multiple target inverse RNA folding. BMC Bioinforma. 13 , 260 (2012). 

24. Rubio-Largo, Ã., Vanneschi, L., Castelli, M. & Vega-RodrÃ­guez, M. A. Multiobjective metaheuristic to design RNA sequences. IEEE Trans. Evol. Comput. 23 , 156â€“169 (2019). 

25. Garcia-Martin, J. A., Clote, P. & Dotu, I. RNAiFOLD: a constraint programming algorithm for RNA inverse folding and molecular design. J. Bioinform. Comput. Biol. 11 , 1350001 (2013). 

26. Kleinkauf, R., Mann, M. & Backofen, R. antaRNA: ant colony-based RNA sequence design. Bioinformatics 31 , 3114â€“3121 (2015). 

27. Yang, X., Yoshizoe, K., Taneda, A. & Tsuda, K. RNA inverse folding using Monte Carlo tree search. BMC Bioinforma. 18 ,468 (2017). 

28. Shi, J., Das, R. & Pande, V. S. SentRNA: Improving computational RNA design by incorporating a prior of human design strategies. arXiv preprint arXiv:1803.03146 (2018). 

29. Koodli, R. V. et al. EternaBrain: automated RNA design through move sets and strategies from an internet-scale RNA videogame. PLOS Comput. Biol. 15 , e1007059 (2019). 

30. Eastman, P., Shi, J., Ramsundar, B. & Pande, V. S. Solving the RNA design problem with reinforcement learning. PLOS Comput. Biol. 14 , e1006176 (2018). 

31. Runge, F., Stoll, D., Falkner, S. & Hutter, F. Learning to design RNA. arXiv preprint arXiv:1812.11951 (2018). 

32. Sumi, S., Hamada, M. & Saito, H. Deep generative design of RNA family sequences. Nat. Methods 21 , 435â€“443 (2024). 

33. Akiyama, M. & Sakakibara, Y. Informative RNA base embedding for RNA structural alignment and clustering by deep representation learning. NAR Genom. Bioinform. 4, lqac012 (2022). 

34. Jones, D. R., Schonlau, M. & Welch, W. J. Efficient global optimization of expensive black-box functions. J. Glob. Optim. 

13 , 455â€“492 (1998). 

35. Forrester, A. I. & Keane, A. J. Recent advances in surrogate-based optimization. Prog. Aerosp. Sci. 45 , 50â€“79 (2009). 

36. Ramu, P. et al. A survey of machine learning techniques in structural and multidisciplinary optimization. Struct. Multidiscip. Optim. 65 , 266 (2022). 

37. Tamura, R. et al. Black-box optimization using factorization and ising machines. arXiv preprint arXiv:2507.18003 (2025). 

38. Rendle, S. Factorization machines. In 2010 IEEE International conference on data mining , 995â€“1000 (2010). 

> 12/17

39. Kitai, K. et al. Designing metamaterials with quantum annealing and factorization machines. Phys. Rev. Res. 2 (2020). Art. no. 013319. 

40. Mohseni, N., McMahon, P. L. & Byrnes, T. Ising machines as hardware solvers of combinatorial optimization problems. 

Nat. Rev. Phys. 4, 363â€“379 (2022). 

41. Johnson, M. W. et al. Quantum annealing with manufactured spins. Nature 473 , 194â€“198 (2011). 

42. Kadowaki, T. & Nishimori, H. Quantum annealing in the transverse Ising model. Phys. Rev. E 58 , 5355â€“5363 (1998). 

43. Farhi, E., Goldstone, J., Gutmann, S. & Sipser, M. Quantum computation by adiabatic evolution. arXiv preprint quant-ph/0001106 (2000). 

44. Tsukamoto, S., Takatsu, M., Matsubara, S. & Tamura, H. An accelerator architecture for combinatorial optimization problems. Fujitsu Sci. Tech. J. 53 , 8â€“13 (2017). 

45. Okuyama, T., Hayashi, M. & Yamaoka, M. An Ising computer based on simulated quantum annealing by path integral Monte Carlo method. In 2017 IEEE international conference on rebooting computing (ICRC) , 1â€“6 (IEEE, 2017). 

46. Goto, H. et al. High-performance combinatorial optimization based on classical mechanics. Sci. Adv. 7 (2021). Art. no. eabe7953. 

47. Fixstars Amplify. Fixstars Amplify Annealing Engine. https://amplify.fixstars.com/en/. 

48. Kirkpatrick, S., Gelatt, C. D. & Vecchi, M. P. Optimization by simulated annealing. Science 220 , 671â€“680 (1983). 

49. Johnson, D. S., Aragon, C. R., McGeoch, L. A. & Schevon, C. Optimization by simulated annealing: An experimental evaluation; part II, graph coloring and number partitioning. Oper. Res. 39 , 378â€“406 (1991). 

50. Das, A. & Chakrabarti, B. K. Quantum annealing and related optimization methods , vol. 679 (Springer Science & Business Media, 2005). 

51. Goto, H., Tatsumura, K. & Dixon, A. R. Combinatorial optimization by simulating adiabatic bifurcations in nonlinear Hamiltonian systems. Sci. Adv. 5 (2019). Art. no. eaav2372. 

52. Nawa, K., Suzuki, T., Masuda, K., Tanaka, S. & Miura, Y. Quantum annealing optimization method for the design of barrier materials in magnetic tunnel junctions. Phys. Rev. Appl. 20 (2023). Art. no. 024044. 

53. Kim, S. et al. Quantum annealing-aided design of an ultrathin-metamaterial optical diode. Nano Converg. 11 , 16 (2024). 

54. CouziniÃ©, Y. et al. Machine learning supported annealing for prediction of grand canonical crystal structures. J. Phys. Soc. Jpn. 94 , 044802 (2025). 

55. Tucs, A. et al. Quantum annealing designs nonhemolytic antimicrobial peptides in a discrete latent space. ACS Med. Chem. Lett. 14 , 577â€“582 (2023). 

56. Huang, X. & Ju, S. Tutorial: AI-assisted exploration and active design of polymers with high intrinsic thermal conductivity. 

J. Appl. Phys. 135 (2024). 

57. Matsumori, T., Taki, M. & Kadowaki, T. Application of QUBO solver using black-box optimization to structural design for resonance avoidance. Sci. Rep. 12 (2022). Art. no. 12143. 

58. Inoue, T. et al. Towards optimization of photonic-crystal surface-emitting lasers via quantum annealing. Opt. Express 30 ,43503â€“43512 (2022). 

59. Tamura, R. et al. Machine learning prediction of the mechanical properties of injection-molded polypropylene through X-ray diffraction analysis. Sci. Technol. Adv. Mater. 25 , 2388016 (2024). 

60. Kikuchi, S. & Tanaka, S. High-order epistasis detection using factorization machine with quadratic optimization annealing and MDR-based evaluation. arXiv preprint arXiv:2602.01860 (2026). 

61. Seki, Y., Tamura, R. & Tanaka, S. Black-box optimization for integer-variable problems using Ising machines and factorization machines. arXiv preprint arXiv:2209.01016 (2022). 

62. Koshikawa, S., Hosaka, A. & Yoshida, T. Efficient bit labeling in factorization machines with annealing for traveling salesman problem. Sci. Rep. 15 , 26910 (2025). 

63. Chancellor, N. Domain wall encoding of discrete variables for quantum annealing and QAOA. Quantum Sci. Technol. 4

(2019). Art. no. 045004. 

64. Tamura, K., Shirai, T., Katsura, H., Tanaka, S. & Togawa, N. Performance comparison of typical binary-integer encodings in an Ising machine. IEEE Access 9, 81032â€“81039 (2021). 

> 13/17

65. Chen, J., Stollenwerk, T. & Chancellor, N. Performance of domain-wall encoding for quantum annealing. IEEE Trans. Quantum Eng. 2, 1â€“14 (2021). 

66. Kikuchi, S., Takahashi, K. & Tanaka, S. Performance of domain-wall encoding in digital Ising machine. arXiv preprint arXiv:2410.11198 (2024). 

67. Dirks, R. M., Lin, M., Winfree, E. & Pierce, N. A. Paradigms for computational nucleic acid design. Nucleic Acids Res. 

32 , 1392â€“1403 (2004). 

68. Ward, M., Courtney, E. & Rivas, E. Fitness functions for RNA structure design. Nucleic Acids Res. 51 , e40â€“e40 (2023). 

69. Turner, D. H. & Mathews, D. H. NNDB: the nearest neighbor parameter database for predicting stability of nucleic acid secondary structure. Nucleic Acids Res. 38 , D280â€“D282 (2010). 

70. Lorenz, R. et al. ViennaRNA package 2.0. Algorithms Mol. Biol. 6, 1â€“14 (2011). 

71. Anderson-Lee, J. et al. Principles for predicting RNA secondary structure design difficulty. J. Mol. Biol. 428 , 748â€“757 (2016). 

72. Mathews, D. H. et al. Incorporating chemical modification constraints into a dynamic programming algorithm for prediction of RNA secondary structure. Proc. Natl. Acad. Sci. 101 , 7287â€“7292 (2004). 

73. Blank, J. & Deb, K. pymoo: Multi-objective optimization in Python. IEEE Access 8, 89497â€“89509 (2020). 

## Acknowledgements 

This work was partially supported by the Japan Society for the Promotion of Science (JSPS) KAKENHI (Grant Number JP23H05447), the Council for Science, Technology, and Innovation (CSTI) through the Cross-ministerial Strategic Innovation Promotion Program (SIP), â€œPromoting the application of advanced quantum technology platforms to social issuesâ€ (Funding agency: QST), Japan Science and Technology Agency (JST) (Grant Number JPMJPF2221). S. Tanaka wishes to express their gratitude to the World Premier International Research Center Initiative (WPI), MEXT, Japan, for their support of the Human Biology-Microbiome-Quantum Research Center (Bio2Q). The computations in this work were partially performed using the facilities of the Supercomputer Center, the Institute for Solid State Physics, The University of Tokyo. 

## Author information 

Contributions 

S.K. conducts conceptualization, data curation, formal analysis, investigation, methodology, software, visualization, writingâ€“ original draft, and writingâ€“review & editing. S.T. conducts conceptualization, funding acquisition, project administration, resources, supervision, and writingâ€“review & editing. All authors reviewed the manuscript. 

## Ethics declarations 

Competing interests 

The authors declare no competing interests. 

## Additional information 

Publisherâ€™s note 

Springer Nature remains neutral with regard to jurisdictional claims in published maps and institutional affiliations. 

> 14/17 (a)
> (b)
> (c)

Figure 8. Performance metrics on multiple Eterna100 benchmark target structures. (a) Normalized ensemble defect values obtained by FMQA for each target structure. Crosses indicate the average NED over 10 independent runs. The upper and lower whiskers denote the maximum and minimum NED values, respectively. Black circle and red triangle represent outliers. (b) Success rate. (c) Minimum free energy values. Only success solutions are plotted. When two or more success solutions were obtained, their average MFE value is indicated by a cross marker. When three or more success solutions were obtained, the standard deviation is shown as error bars. 15/17 (a) (b) 

(c) Figure 9. Nucleotide frequencies obtained from the success solutions across different integer-to-nucleotide assignments. (a) Nucleotide frequency in stem regions, (b) nucleotide frequency in non-stem regions, and (c) nucleotide frequency over the entire RNA sequence. The baseline value of 0.25 corresponds to the expected frequency under a random uniform nucleotide frequency. Red indicates frequencies higher than 0.25, whereas blue indicates frequencies lower than 0.25. 16/17 (a) (b) 

> (c)

Figure 10. Performance metrics for different values of the hyperparameter K under each binary-integer encoding method. (a) Normalized ensemble defect values obtained by FMQA for each encoding method and value of K. Crosses indicate the average NED over 10 independent runs. The upper and lower whiskers denote the maximum and minimum NED values, respectively. Black circle, red triangle, blue square, and green diamond represent outliers. (b) Success rate. (c) Minimum free energy values of the success solutions. Only success solutions are plotted. When two or more success solutions were obtained, their average MFE value is indicated by a cross marker. When three or more success solutions were obtained, the standard deviation is shown as error bars.